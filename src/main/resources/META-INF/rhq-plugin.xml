<?xml version="1.0" encoding="UTF-8" ?>
<plugin name="Apache-Hadoop-RHQ-Plugin"
        displayName="Apache Hadoop RHQ Plugin"
        description="Apache Hadoop RHQ Plugin"
        version="0.1"
        xsi:noNamespaceSchemaLocation="rhq-plugin.xsd"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns="urn:xmlns:rhq-plugin"
        xmlns:c="urn:xmlns:rhq-configuration">

    <depends plugin="JMX" useClasses="true"/>

    <service name="NameNode"
             description="NameNode"
             discovery="org.rhq.plugins.jmx.MBeanResourceDiscoveryComponent"
             class="org.rhq.plugins.jmx.MBeanResourceComponent">

        <runs-inside>
            <parent-resource-type name="JMX Server" plugin="JMX"/>
        </runs-inside>

        <plugin-configuration>
            <c:simple-property name="objectName" default="Hadoop:service=NameNode,name=NameNode"/>
        </plugin-configuration>

        <metric property="AddBlockOps"
                displayName="AddBlockOps"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="AddBlockOps"/>

        <metric property="CreateFileOps"
                displayName="CreateFileOps"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="CreateFileOps"/>

        <metric property="DeleteFileOps"
                displayName="DeleteFileOps"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="DeleteFileOps"/>

        <metric property="FileInfoOps"
                displayName="FileInfoOps"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="FileInfoOps"/>

        <metric property="FilesAppended"
                displayName="FilesAppended"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="FilesAppended"/>

        <metric property="FilesCreated"
                displayName="FilesCreated"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="FilesCreated"/>

        <metric property="FilesDeleted"
                displayName="FilesDeleted"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="FilesDeleted"/>

        <metric property="FilesInGetListingOps"
                displayName="FilesInGetListingOps"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="FilesInGetListingOps"/>

        <metric property="FilesRenamed"
                displayName="FilesRenamed"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="none"
                description="FilesRenamed"/>

        <metric displayName="tag.context" property="tag.context"
                description="tag.context"
                dataType="trait" displayType="summary"/>

        <metric displayName="tag.hostName" property="tag.hostName"
                description="tag.hostName"
                dataType="trait" displayType="summary"/>

    </service>

    <service name="NameNodeInfo"
             description="NameNodeInfo"
             discovery="org.rhq.plugins.jmx.MBeanResourceDiscoveryComponent"
             class="org.rhq.plugins.jmx.MBeanResourceComponent">

        <runs-inside>
            <parent-resource-type name="JMX Server" plugin="JMX"/>
        </runs-inside>

        <plugin-configuration>
            <c:simple-property name="objectName" default="Hadoop:service=NameNode,name=NameNodeInfo"/>
        </plugin-configuration>

        <metric property="Free"
                displayName="Free"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="bytes"
                description="Free"/>

        <metric property="PercentRemaining"
                displayName="PercentRemaining"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="percentage"
                description="DFS Remaining%"/>

        <metric displayName="Version" property="Version"
                description="Version"
                dataType="trait" displayType="summary"/>

    </service>

    <service name="FSNamesystemState"
             description="FSNamesystemState"
             discovery="org.rhq.plugins.jmx.MBeanResourceDiscoveryComponent"
             class="org.rhq.plugins.jmx.MBeanResourceComponent">

        <runs-inside>
            <parent-resource-type name="JMX Server" plugin="JMX"/>
        </runs-inside>

        <plugin-configuration>
            <c:simple-property name="objectName" default="Hadoop:service=NameNode,name=FSNamesystemState"/>
        </plugin-configuration>

        <metric property="CapacityTotal"
                displayName="CapacityTotal"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="bytes"
                description="DFS Configured capacitiy"/>

        <metric property="CapacityUsed"
                displayName="CapacityUsed"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="bytes"
                description="DFS used"/>

        <metric property="CapacityRemaining"
                displayName="CapacityRemaining"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="bytes"
                description="DFS remaining"/>

        <metric property="BlocksTotal"
                displayName="BlocksTotal"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="none"
                description="BlocksTotal"/>

        <metric property="FilesTotal"
                displayName="FilesTotal"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="none"
                description="FilesTotal"/>

        <metric property="PendingReplicationBlocks"
                displayName="PendingReplicationBlocks"
                defaultOn="true"
                displayType="summary"
                defaultInterval="3600000"
                units="none"
                description="PendingReplicationBlocks"/>

    </service>


    <service name="DataNode"
             description="DataNode"
             discovery="org.rhq.plugins.jmx.MBeanResourceDiscoveryComponent"
             class="org.rhq.plugins.jmx.MBeanResourceComponent">

        <runs-inside>
            <parent-resource-type name="JMX Server" plugin="JMX"/>
        </runs-inside>

        <plugin-configuration>
            <c:simple-property name="objectName" default="Hadoop:service=DataNode,name=DataNode"/>
        </plugin-configuration>

        <metric property="bytes_read"
                displayName="bytes_read"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="bytes"
                description="bytes_read"/>

        <metric property="bytes_written"
                displayName="bytes_written"
                defaultOn="true"
                displayType="summary"
                defaultInterval="60000"
                units="bytes"
                description="bytes_written"/>

    </service>

    <service name="FSDatasetState"
             description="FSDatasetState"
             discovery="org.rhq.plugins.jmx.MBeanResourceDiscoveryComponent"
             class="org.rhq.plugins.jmx.MBeanResourceComponent">

        <runs-inside>
            <parent-resource-type name="JMX Server" plugin="JMX"/>
        </runs-inside>

        <plugin-configuration>
            <c:simple-property name="objectName"
                               default="Hadoop:service=DataNode,name=FSDatasetState*"/>
        </plugin-configuration>

        <metric property="Capacity"
                displayName="Capacity"
                defaultOn="true"
                displayType="summary"
                defaultInterval="600000"
                units="bytes"
                description="Capacity"/>

        <metric property="DfsUsed"
                displayName="DfsUsed"
                defaultOn="true"
                displayType="summary"
                defaultInterval="600000"
                units="bytes"
                description="DfsUsed"/>

        <metric property="Remaining"
                displayName="Remaining"
                defaultOn="true"
                displayType="summary"
                defaultInterval="600000"
                units="bytes"
                description="Remaining"/>

        <metric displayName="StorageInfo" property="StorageInfo"
                description="StorageInfo"
                dataType="trait" displayType="summary"/>

    </service>

</plugin>
